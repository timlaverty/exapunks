;READ SEEK LOC & DATA
GRAB 300
;FILE LOCATION
REPL SEEKER
;SEND ENTRYID TO SEEKER
COPY F M
DROP

;CREATE NEW FILE???
MAKE

HALT



MARK SEEKER
LINK 800
;FIND CUSTOMER FILE
;GET FILE, GO TO END
;GET ENTRYID FROM PARENT
COPY M X
GRAB 199

;SEARCH CUST FILENAME
MARK CHECKENTRY
TEST F = X
TJMP FOUNDENTRY
SEEK 2
FJMP CHECKENTRY

MARK FOUNDENTRY
;CUSTOMER FILENAME
SEEK 1
COPY F T
DROP

;CHECK FOR FILE IN 799
LINK 799
REPL FINDFILEIN799

;WAIT 2 CYCLES FOR WRKR
NOOP
NOOP
;SEE IF THE FINDER WROTE
TEST MRD
FJMP SEARCH801
VOID M
HALT

;CHECK FOR FILE IN 801
MARK SEARCH801
LINK 800
LINK 801
GRAB T
COPY 1 T
TJMP PROCESSFILE

MARK FINDFILEIN799
GRAB T
;SIGNAL THAT WE FOUND IT
COPY 1 M

;PROCESS THE FILE
MARK PROCESSFILE
SEEK 2
COPY 0 X

MARK ADDVALUES
ADDI F X X
TEST EOF
FJMP ADDVALUES

;LAST TRANSACTION 2WRITE
;...WHERE TO STORE THIS.
MODI X 75 T
REPL VALUESTORER

;HOW MANY TRANSACTIONS
DIVI X 75 X

;MOVE TO THE FRONT
SEEK -9999
SEEK 2
MARK WRITEVALUES
COPY 75 F
SUBI X 1 X
TEST X = 0
FJMP WRITEVALUES
COPY M F
DROP 
HALT


MARK VALUESTORER
COPY T M
HALT





